# C++ Command Injection baseline fixture
# Ensures cpp fixture language is represented in generic per-language quality gates.

id: "CPP-RAW-POINTER"
name: "C++ Raw Pointer Safety"
language: "cpp"
vulnerability_type: "memory_safety"
severity: "medium"
cwe:
  - "CWE-401"
impact: "Raw pointers increase memory management risk"

test_cases:
  - name: "raw pointer allocation with new"
    vulnerable: true
    code: |
      int* make_ptr() {
          int* value = new int(42);
          return value;
      }
    expected_findings:
      - rule_id: "cpp-raw-ptr"

  - name: "stack allocation without raw new (safe)"
    vulnerable: false
    code: |
      void run_safe() {
          int value = 42;
          (void)value;
      }
