//! Vulnerability repository traits

use async_trait::async_trait;

use super::entities::{Package, Vulnerability};
use super::value_objects::VulnerabilityId;
use crate::application::errors::VulnerabilityError;

/// Repository trait for vulnerability data access
#[async_trait]
pub trait IVulnerabilityRepository: Send + Sync {
    /// Find vulnerabilities for a given package
    async fn find_vulnerabilities(
        &self,
        package: &Package,
    ) -> Result<Vec<Vulnerability>, VulnerabilityError>;

    /// Get a specific vulnerability by its ID
    async fn get_vulnerability_by_id(
        &self,
        id: &VulnerabilityId,
    ) -> Result<Option<Vulnerability>, VulnerabilityError>;
}


